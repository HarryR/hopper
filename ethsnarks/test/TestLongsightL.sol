pragma solidity ^0.4.24;

import "truffle/Assert.sol";
import "../contracts/LongsightL.sol";


contract TestLongsightL
{
	function testKnownL12 () public
	{
		uint256[10] memory round_constants;
		LongsightL.ConstantsL12p5(round_constants);

		uint256 x = 3703141493535563179657531719960160174296085208671919316200479060314459804651;
		uint256 k = 134551314051432487569247388144051420116740427803855572138106146683954151557;
		uint256 expected = 14412061461933611701703094472891440142598479500786943729495502117590964244418;

		uint256 result = LongsightL.LongsightL12p5(x, k, round_constants);

		Assert.equal(result, expected, "Unexpected result");
	}

	function testKnownL12_MP () public
	{
		uint256[10] memory round_constants;
		LongsightL.ConstantsL12p5(round_constants);

		uint256 m_0 = 3703141493535563179657531719960160174296085208671919316200479060314459804651;
		uint256 m_1 = 134551314051432487569247388144051420116740427803855572138106146683954151557;
		uint256 IV = 918403109389145570117360101535982733651217667914747213867238065296420114726;

		uint256 expected = 17828528097540207980615582400605592397196799544205247666616062148860893885796;

		uint256 result = LongsightL.LongsightL12p5_MP([m_0, m_1], IV, round_constants);

		Assert.equal(result, expected, "Unexpected result");
	}
}
